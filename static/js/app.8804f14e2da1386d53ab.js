webpackJsonp([1],{"7Xcd":function(t,e){},"9IuC":function(t,e){},D7sX:function(t,e){},Loxx:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),n=s("Dd8w"),o=s.n(n),a=s("NYxO"),r={name:"App",methods:o()({},Object(a.b)(["setSocketId"])),sockets:{connect:function(){console.log("socket connected"),console.log(this.$socket.id),this.setSocketId({id:this.$socket.id})}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var h=s("VU/8")(r,c,!1,function(t){s("b/GM")},null,null).exports,u=s("/ocq"),l={name:"Main",data:function(){return{username:"",errorMsg:""}},methods:o()({},Object(a.b)(["setUsername"]),{signIn:function(){this.username?this.username.length<3?this.showAlert("昵称太短啦"):(this.setUsername({username:this.username}),sessionStorage.setItem("username",this.username),this.$router.push({path:"/control"})):this.showAlert("昵称不能为空")},showAlert:function(t){var e=this;this.errorMsg=t||"出错了",setTimeout(function(){e.errorMsg=""},2500)}})},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-wrap"},[s("div",{staticClass:"main-cont"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.username,expression:"username",modifiers:{trim:!0}}],staticClass:"main-input",attrs:{type:"text",placeholder:"大佬，给自己起个名吧"},domProps:{value:t.username},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.signIn(e):null},input:function(e){e.target.composing||(t.username=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),t.errorMsg?s("div",{staticClass:"main-alert"},[t._v(t._s(t.errorMsg))]):t._e()])])},staticRenderFns:[]};var p=s("VU/8")(l,f,!1,function(t){s("Loxx")},null,null).exports,d={name:"MaskWrap",data:function(){return{display:"none",opacity:0,scaleCls:!1}},methods:{show:function(){var t=this;setTimeout(function(){t.display="flex",setTimeout(function(){t.opacity=1,setTimeout(function(){t.scaleCls=!0},200)},1)},200)},hide:function(){var t=this;this.opacity=0,this.scaleCls=!1,setTimeout(function(){t.display="none"},200)}}},m={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mask-wrap",style:{display:this.display,opacity:this.opacity},on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}}},[e("div",{staticClass:"mask-alert",class:{"mask-alert-active":this.scaleCls}},[this._v("\n    请旋转手机，横屏操作更佳\n  ")])])},staticRenderFns:[]};var v={name:"Ruler",data:function(){return{left:-1,top:-1}},methods:{updatePos:function(t){var e=t.targetTouches[0]||t.changedTouches[0];if(e){var s=e.clientX,i=e.clientY;this.left=s,this.top=i}}},mounted:function(){window.addEventListener("touchmove",this.updatePos),window.addEventListener("touchstart",this.updatePos)}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ruler-wrap",on:{touchmove:function(t){t.preventDefault(),t.stopPropagation()}}},[e("div",{staticClass:"vertical-line",style:{left:this.left+"px"}}),this._v(" "),e("div",{staticClass:"horizontal-line",style:{top:this.top+"px"}})])},staticRenderFns:[]};var b=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},A={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stateBar clearfix"},[s("div",{staticClass:"stateItem clearfix fl"},[s("div",{staticClass:"stateTitle fl"},[t._v("前后：")]),t._v(" "),s("div",{staticClass:"stateValue fl"},[t._v(t._s(t.direction?"forward"===t.direction?"向前":"向后":"静止"))])]),t._v(" "),s("div",{staticClass:"stateItem clearfix fl"},[s("div",{staticClass:"stateTitle fl"},[t._v("左右：")]),t._v(" "),s("div",{staticClass:"stateValue fl"},[t._v(t._s(t.side?"left"===t.side?"向左":"向右":"静止"))])]),t._v(" "),s("div",{staticClass:"stateItem clearfix fl"},[s("div",{staticClass:"stateTitle fl"},[t._v("sin值：")]),t._v(" "),s("div",{staticClass:"stateValue fl"},[t._v(t._s(t.sin))])]),t._v(" "),s("div",{staticClass:"stateItem clearfix fl"},[s("div",{staticClass:"stateTitle fl"},[t._v("cos值：")]),t._v(" "),s("div",{staticClass:"stateValue fl"},[t._v(t._s(t.cos))])])])},staticRenderFns:[]};var g={name:"Control",components:{"mask-wrap":s("VU/8")(d,m,!1,function(t){s("9IuC")},null,null).exports,"ruler-wrap":s("VU/8")(v,w,!1,function(t){s("eiPW")},null,null).exports,"state-wrap":s("VU/8")({name:"StateBar",props:["direction","sin","cos","side"]},A,!1,function(t){s("D7sX")},null,null).exports},computed:o()({},Object(a.c)({username:function(t){return t.Main.username},id:function(t){return t.Main.id}})),mounted:function(){this.username?(this.$socket.emit("setUsername",{username:this.username}),this.checkPosition(),this.addListener()):this.$router.push({path:"/"})},data:function(){return{show:!1,wrapR:60,btnTop:-30,btnLeft:-30,btnR:30,btnCenterX:0,btnCenterY:0,offsetPos:0,toTop:0,toLeft:0,touchStart:!1,fire:!1,direction:0,sin:0,cos:0,side:0}},methods:{checkPosition:function(){document.body.clientWidth<document.body.clientHeight?(this.$refs.maskWrap.show(),this.show=!1):(this.$refs.maskWrap.hide(),this.show=!0)},addListener:function(){var t=this;window.onresize=function(){t.checkPosition()}},handleTouchStart:function(t){0===this.toTop&&(this.toTop=this.$refs.posControl.offsetTop,this.toLeft=this.$refs.posControl.offsetLeft,this.btnCenterY=this.toTop+this.btnR,this.btnCenterX=this.toLeft+this.btnR,this.offsetPos=this.btnR,this.btnTop=0-this.btnR,this.btnLeft=0-this.btnR);var e=t.targetTouches[0].clientX,s=t.targetTouches[0].clientY;this.touchStart=!0,this.btnTop=s-this.toTop-this.wrapR-this.offsetPos,this.btnLeft=e-this.toLeft-this.wrapR-this.offsetPos;var i=s-(this.toTop+this.wrapR);this.checkDirection(i)},handleTouchMove:function(t){var e=t.targetTouches[0].clientX,s=t.targetTouches[0].clientY;if(this.touchStart){var i=Math.abs(e-(this.toLeft+this.wrapR)),n=Math.abs(s-(this.toTop+this.wrapR)),o=s-(this.toTop+this.wrapR);if(this.checkDirection(o),b(i,n)<this.wrapR)this.btnTop=s-this.toTop-this.wrapR-this.offsetPos,this.btnLeft=e-this.toLeft-this.wrapR-this.offsetPos;else{var a=(e-this.toLeft-this.wrapR)*this.wrapR/b(i,n)-this.btnR,r=(s-this.toTop-this.wrapR)*this.wrapR/b(i,n)-this.btnR;this.btnLeft=a,this.btnTop=r}}},handleTouchEnd:function(t){this.touchStart=!1,this.btnTop=0-this.btnR,this.btnLeft=0-this.btnR,this.direction=0,this.sin=0,this.cos=0,this.side=0},startFire:function(){this.fire=!0},endFire:function(){this.fire=!1},checkDirection:function(t){this.direction||(this.direction=t>5?"back":"forward");var e=this.btnLeft+30,s=this.btnTop+30,i=Math.abs(e/this.wrapR),n=Math.abs(s/this.wrapR);"forward"===this.direction?e>0&&s<0||0===e&&s<0||e<0&&s<0?(this.sin=parseFloat(i.toFixed(3)),this.cos=parseFloat(n.toFixed(3))):(this.sin=1,this.cos=0):e<0&&s>0||0===e&&s>0||e>0&&s>0?(this.sin=parseFloat(i.toFixed(3)),this.cos=parseFloat(n.toFixed(3))):(this.sin=1,this.cos=0),this.side=e>0?"right":e<0?"left":0}},watch:{direction:function(){},sin:function(){},side:function(){}}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"control-wrap",on:{touchmove:function(e){return e.preventDefault(),t.handleTouchMove(e)},touchend:t.handleTouchEnd}},[i("mask-wrap",{ref:"maskWrap"}),t._v(" "),i("ruler-wrap"),t._v(" "),t.show?i("state-wrap",{attrs:{side:t.side,direction:t.direction,sin:t.sin,cos:t.cos}}):t._e(),t._v(" "),t.show?i("div",{ref:"posControl",staticClass:"pos-control",on:{touchstart:t.handleTouchStart}},[i("div",{staticClass:"pos-btn",style:{left:t.btnLeft+"px",top:t.btnTop+"px"}})]):t._e(),t._v(" "),t.show?i("div",{staticClass:"fire-control",class:{"fire-control-active":t.fire},on:{touchstart:function(e){return e.stopPropagation(),e.preventDefault(),t.startFire(e)},touchend:function(e){return e.stopPropagation(),e.preventDefault(),t.endFire(e)},touchmove:function(t){t.stopPropagation(),t.preventDefault()}}},[i("img",{attrs:{src:s("gfE7"),alt:""}})]):t._e()],1)},staticRenderFns:[]};var k=s("VU/8")(g,C,!1,function(t){s("7Xcd")},null,null).exports;i.a.use(u.a);var R=new u.a({routes:[{path:"/",name:"Main",component:p},{path:"/control",name:"Control",component:k}]}),T=(s("sax8"),{state:{username:sessionStorage.getItem("username")||"",id:0},getters:{},actions:{},mutations:{setSocketId:function(t,e){t.id=e.id},setUsername:function(t,e){t.username=e.username}}});i.a.use(a.a);var _=new a.a.Store({modules:{Main:T},strict:!1,plugins:[]}),M=s("hMcO"),x=s.n(M);i.a.use(x.a,"http://192.168.2.105:3000?type=player"),i.a.config.productionTip=!1,new i.a({el:"#app",store:_,router:R,components:{App:h},template:"<App/>"})},"b/GM":function(t,e){},eiPW:function(t,e){},gfE7:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAACcUlEQVRYR+1X23EUQQzsjgATATgCcARABOAIjCMAIgBHwBEBdgSYCHxEgIkAEwEmAlG9pbmaW+YhdvbDVKG/q9XO9LXULS1xx4J3DA+GAZnZQ5I3a/2xNQAZgA2AM5K3o8DWAiQc1wCejYIaAmRmjwF8zVgZBjUK6DWA97MyXZI8Xlq6UUCXAJ4XLj8mqWd/HYsBSV0AvlduvCF5qGdmJhbPo701AugcwEmDgjckN2b2zlkMNfwiQB12EsaJJQf01lk67dUwBMjMNiRF/RRmdgXgae9wAEcA9F5isttbUUA/3WOuzewFgE8BMEpRYyt/j7XWu11AZiYmxIjo3rrvHAQBldLk6OqrYkQApfKceXPKDPP45T/uBUHuFFjKbwKaObHmVI2Z+z7PWqrL76/2Ug9QT9rpEkl6a2YvAXwMMPUhF0meXwUUkLZKlco0AXIFRpr+C8miSluASnNqj3Yv0wNX4ATIQXWZIlm8uwVIFzypqoFkZgFHJDXpd2FmzXIvAaTFqxYXJMWCTHJbot/MJABtkkX1rQ1ox4iUOGcnK502yVeFf/WN5Nw+prRWyWoM7djpqanh6otUpp54VLj0MLrUFzbKdNwfPZcetBiSvWtK51GlusRWBdBnkvl823u1BUhNKZYk6xRV/6gAmnuSvEs9V/1s6jn1fIm/JakxEYqC9MfXD29MeUqS77QJ9hBlW0JKPSWpc5rRnfbuNWJKu43KpyGrUbFnhPkt7kHat1X2H9qJWvn5uyFADkqHq9EnX6kZm+emr5ELbYzRBb/pQzVefeiqMaufOZ5zEGVlEUO92q/1PFyytS7snfMf0D/H0G/VBgo0yaW3uQAAAABJRU5ErkJggg=="}},["NHnr"]);
//# sourceMappingURL=app.8804f14e2da1386d53ab.js.map